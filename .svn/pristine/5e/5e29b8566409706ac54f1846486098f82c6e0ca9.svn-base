<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="jakarta.tags.fmt" prefix="fmt" %>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %>
<%@ taglib uri="jakarta.tags.functions" prefix="fn" %>
<%@ taglib uri="jakarta.tags.core"  prefix="c"%>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚˜ì˜ í”„ë¡œí•„</title>
<%@ include file="../../modules/headerPart.jsp" %>
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/pages/mainservice_common.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/pages/artist_community.css">
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/pages/my_profile.css">
</head>

<body>
    
	<header class="site-header">
    <div class="logo">
      <a href="artist_community_main.html">DDTOWN SQUARE</a>
    </div>
    <nav class="utility-nav">
      <ul id="loggedOutNav">
        <li><a href="#" id="loginBtn" class="auth-link">ë¡œê·¸ì¸</a></li>
        <li><a href="signup.html" class="signup-link">íšŒì›ê°€ì…</a></li>
      </ul>
      <ul id="loggedInNav" style="display: none">
        <li><a href="#" id="notificationBtn" class="icon-btn" title="ì•Œë¦¼">ğŸ””</a></li>
        <li><a href="#" id="myPageBtn" class="icon-btn" title="ë§ˆì´í˜ì´ì§€">ğŸ‘¤</a></li>
        <li><a href="#" class="icon-btn" title="ì»¬ë ‰ì…˜">ğŸŒŸ</a></li>
        <li><a href="#" class="icon-btn special-icon" title="ìŠ¤í˜ì…œ">J</a></li>
        <li><a href="#" class="icon-btn" title="ë”ë³´ê¸°">ğŸ›ï¸</a></li>
        <li><a href="#" id="logoutBtn" class="auth-link">ë¡œê·¸ì•„ì›ƒ</a></li>
      </ul>
    </nav>
  </header>
  <nav class="main-navigation">
    <ul>
      <li><a href="#">êµ¿ì¦ˆìƒµ</a></li>
      <li>
        <a href="preference_vote.html">ì„ í˜¸ë„ ì¡°ì‚¬</a>
        <ul class="submenu">
          <li><a href="preference_vote.html" style="color: #8a2be2; font-weight:bold;">ì¸ê¸° íˆ¬í‘œ</a></li>
        </ul>
      </li>
    </ul>
  </nav>
	${profileVO}
  <main class="profile-main">
    <header class="profile-header">
      <div class="profile-header-inner">
        <div class="profile-avatar">
          <img src="${profileVO.comuProfileImg}" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
        </div>
        <div class="profile-nickname" id="profileNickname">${profileVO.comuNicknm}</div>
      </div>
    </header>
    <nav class="profile-tabs">
      <button class="tab active" data-tab="posts">í¬ìŠ¤íŠ¸</button>
      <button class="tab" data-tab="comments">ëŒ“ê¸€</button>
    </nav>
    <section class="profile-tab-content" id="postsTab" style="display:block;">
    	<c:choose>
    		<c:when test="${empty profileVO.postList}">
		      <div class="no-content">ì•„ì§ ì‘ì„±í•œ í¬ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
    		</c:when>
    		<c:otherwise>
    			<c:forEach items="${profileVO.postList}" var="post">
    				${post}
    			</c:forEach>
    		</c:otherwise>
    	</c:choose>
    </section>
    <section class="profile-tab-content" id="commentsTab" style="display:none;">
      <div class="no-content">ì•„ì§ ì‘ì„±í•œ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
    </section>
  </main>

  <div id="footer-placeholder"></div>

</body>
<script type="text/javascript">
// íƒ­ ì „í™˜
document.querySelectorAll('.profile-tabs .tab').forEach(tab => {
  tab.addEventListener('click', function() {
    document.querySelectorAll('.profile-tabs .tab').forEach(t => t.classList.remove('active'));
    this.classList.add('active');
    document.getElementById('postsTab').style.display = this.dataset.tab === 'posts' ? 'block' : 'none';
    document.getElementById('commentsTab').style.display = this.dataset.tab === 'comments' ? 'block' : 'none';
  });
});

// ë¡œê·¸ì¸ ìƒíƒœ ê´€ë¦¬ (ê³µí†µ)
const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const loggedOutNav = document.getElementById("loggedOutNav");
const loggedInNav = document.getElementById("loggedInNav");
let isLoggedIn = JSON.parse(localStorage.getItem("isUserLoggedIn")) || false;
function updateNav() {
  if (isLoggedIn) {
    loggedOutNav.style.display = "none";
    loggedInNav.style.display = "flex";
  } else {
    loggedOutNav.style.display = "flex";
    loggedInNav.style.display = "none";
  }
}
if (loginBtn) {
  loginBtn.addEventListener("click", function (event) {
    event.preventDefault();
    isLoggedIn = true;
    localStorage.setItem("isUserLoggedIn", JSON.stringify(isLoggedIn));
    updateNav();
  });
}
if (logoutBtn) {
  logoutBtn.addEventListener("click", function (event) {
    event.preventDefault();
    isLoggedIn = false;
    localStorage.setItem("isUserLoggedIn", JSON.stringify(isLoggedIn));
    updateNav();
  });
}
updateNav();
</script>
</html>