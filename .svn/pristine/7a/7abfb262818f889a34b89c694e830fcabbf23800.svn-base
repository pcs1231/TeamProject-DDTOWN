<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib uri="jakarta.tags.functions" prefix="fn" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDTOWN - 오디션 일정 상세페이지</title>
    
    <%-- 기존 포털 공통 CSS --%>
    <link rel="stylesheet" href="<%=request.getContextPath()%>/resources/css/pages/emp_common.css">
    <link rel="stylesheet" href="<%=request.getContextPath()%>/resources/css/pages/emp_portal_style.css">
    <link rel="stylesheet" href="<%=request.getContextPath()%>/resources/css/pages/audition_management_style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
</head>
<body>
     <div class="emp-container">
        <header class="emp-header">
            <div class="emp-logo">
                <a href="<%=request.getContextPath()%>/emp_portal.jsp">DDTOWN 직원 포털</a>
            </div>
            <div class="emp-user-info">
                <span><i class="fas fa-user-circle"></i> 안녕하세요, <strong id="employee-name">홍길동</strong>님</span>
                <a href="#logout" class="emp-logout-btn"><i class="fas fa-sign-out-alt"></i> 로그아웃</a>
            </div>
        </header>
        <div class="emp-body-wrapper">
            <aside class="emp-sidebar">
                <nav class="emp-nav">
                    <ul>
                        <li>
                            <a href="#" class="emp-nav-item has-submenu" data-menu="approval">
                                <i class="fas fa-file-signature"></i> 전자결재 <span class="submenu-arrow">&gt;</span>
                            </a>
                            <ul class="emp-submenu" id="submenu-approval">
                                <li><a href="<%=request.getContextPath()%>/1.approval/approval_draft.jsp" class="emp-nav-item">기안서 작성</a></li>
                                <li><a href="<%=request.getContextPath()%>/1.approval/approval_request_list.jsp" class="emp-nav-item">결재 요청 리스트</a></li>
                                <li><a href="<%=request.getContextPath()%>/1.approval/approval_box.jsp" class="emp-nav-item">결재 문서함</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class="emp-nav-item has-submenu" data-menu="audition">
                                <i class="fas fa-microphone-alt"></i> 오디션 관리 <span class="submenu-arrow">&gt;</span>
                            </a>
                            <ul class="emp-submenu" id="submenu-audition">
                                <li><a href="<%=request.getContextPath()%>/2.audition/schedule_management.jsp" class="emp-nav-item">일정 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/2.audition/applicant_info.jsp" class="emp-nav-item">지원자 정보</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class="emp-nav-item has-submenu" data-menu="community">
                                <i class="fas fa-users"></i> 아티스트 커뮤니티 관리 <span class="submenu-arrow">&gt;</span>
                            </a>
                            <ul class="emp-submenu" id="submenu-community">
                                <li>
                                    <a href="#" class="emp-nav-item has-submenu" data-menu="artist-mgmt">아티스트 관리 <span class="submenu-arrow">&gt;</span></a>
                                    <ul class="emp-submenu" id="submenu-artist-mgmt">
                                        <li><a href="<%=request.getContextPath()%>/emp/group/group-management" class="emp-nav-item">그룹 관리</a></li>
                                        <li><a href="<%=request.getContextPath()%>/emp/artist/individual-management" class="emp-nav-item">아티스트 관리</a></li>
                                    </ul>
                                </li>
                                다른 커뮤니티 관련 링크들도 실제 경로에 맞게 수정
                                <li><a href="<%=request.getContextPath()%>/community/notice_management.jsp" class="emp-nav-item">공지사항 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/community/post_management.jsp" class="emp-nav-item">게시물 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/community/live_management.jsp" class="emp-nav-item">라이브 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/community/schedule_management.jsp" class="emp-nav-item">일정 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/community/membership_management.jsp" class="emp-nav-item">멤버십 관리</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class="emp-nav-item has-submenu" data-menu="concert">
                                <i class="fas fa-ticket-alt"></i> 콘서트 관리 <span class="submenu-arrow">&gt;</span>
                            </a>
                            <ul class="emp-submenu" id="submenu-concert">
                                <li><a href="<%=request.getContextPath()%>/4.concert/schedule_management.jsp" class="emp-nav-item">콘서트 일정 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/4.concert/notice_management.jsp" class="emp-nav-item">콘서트 공지사항 관리</a></li>
                                <li><a href="<%=request.getContextPath()%>/4.concert/seat_management.jsp" class="emp-nav-item">콘서트 좌석 관리</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="<%=request.getContextPath()%>/email_tool.jsp" class="emp-nav-item" data-menu="email">
                                <i class="fas fa-envelope-open-text"></i> 이메일 전송
                            </a>
                        </li>
                    </ul>
                </nav>
            </aside>
<!--  main  -->        
			<main>
				<section class="audition-detail-hero">
		            <div class="container">
		                <h2>오디션 상세정보</h2>
		            </div>
		        </section>
				
				<section class="audition-detail-section">
		            <div class="container">
		                <div class="audition-detail-header">
		                    <span class="audition-status recruiting">
		                    	<c:choose>
	                       			<c:when test="${audition.audiStatCode eq 'ADSC001'}">진행중</c:when>
	                       			<c:when test="${audition.audiStatCode eq 'ADSC002'}">마감</c:when>
	                       			<c:when test="${audition.audiStatCode eq 'ADSC003'}">예정됨</c:when>
	                       		</c:choose>
		                    </span>
		                    <h3 class="audition-detail-title">${audition.audiTitle }</h3>
		                </div>
		                <ul class="audition-detail-meta">
		                    <li><strong>모집 분야:</strong>
		                    	<c:choose>
	                       			<c:when test="${audition.audiTypeCode eq 'ADTC001'}">보컬</c:when>
	                       			<c:when test="${audition.audiTypeCode eq 'ADTC002'}">댄스</c:when>
	                       			<c:when test="${audition.audiTypeCode eq 'ADTC003'}">연기</c:when>
		                    	</c:choose></li>
		                    <li><strong>지원 접수 시작일:</strong><c:set value="${fn:split(audition.audiStartDate, ' ')}" var="auditionStartDate"/> ${auditionStartDate[0]}</li>
		                    <li><strong>지원 접수 마감일:</strong><c:set value="${fn:split(audition.audiEndDate, ' ')}" var="auditionEndDate"/> ${auditionEndDate[0]}</li>
			                <li><strong>공고 등록일시:</strong><c:set value="${fn:split(audition.audiRegDate, ' ')}" var="auditionRegDate"/> ${auditionRegDate[0] }</li>
			                <li><strong>공고 수정일시:</strong><c:set value="${fn:split(audition.audiModDate, ' ')}" var="auditionModDate"/> ${auditionModDate[0] }</li>
		                </ul>
		                <div class="audition-detail-content">
		                    <h4>오디션 내용</h4>
		                   <p>
		       				 ${fn:replace(audition.audiContent, '-', '<br><br>-')}
		    				</p>
		                </div>
		                
		                <div class="audition-detail-attachments">
		                <c:if test="${audition.fileGroupNo ne null}">
						    <h4>첨부파일</h4>
						    <ul class="list-unstyled">
						    	<c:if test="${not empty audition.fileList}">
						    		<c:forEach var="file" items="${audition.fileList}">
							    		<li>
								            <a href="<c:url value='/Emp/Audition/download.do'>
								            	 <c:param name='attachDetailNo' value='${file.attachDetailNo}'/>
								            	 </c:url>" class="attachment-link">
								                <i class="fas fa-file-pdf"></i>
								                 ${file.fileOriginalNm}
								            </a>
							        	</li>
						    		</c:forEach>						
						    	</c:if>
						        <c:if test="${empty audition.fileList}">
							        <li>첨부된 파일이 없습니다.</li>
							    </c:if>
						    </ul>
						</c:if>
		                </div>
		                <div class="audition-detail-actions">
		                    <a href="${pageContext.request.contextPath}/emp/audition/schedule" class="btn btn-secondary">
		                        <i class="fas fa-list"></i> 목록
		                    </a>
		                    <a href="/emp/audition/updateForm.do?audiNo=${audition.audiNo }" class="btn btn-primary">
		                        <i class="fas fa-pen"></i> 수정하기
 		                    </a>
		                   <%--  <a href="/emp/audition/delete.do?audiNo=${audition.audiNo }" class="btn btn-primary">
		                        <i class="fas fa-pen">삭제</i>
		                    </a> --%>
							<form action="/emp/audition/delete.do"  method="post" id="delForm">
							<input type="hidden" name="audiNo" value="${audition.audiNo}" />
		                   <button type="submit" class="btn btn-primary" id="delBtn">삭제</button>
		                   <sec:csrfInput/>
							</form>
		                </div>
		            </div>
		        </section>
			</main>  
		    </div>
		<footer class="emp-footer">
			<p>&copy; 2025 DDTOWN Entertainment. All rights reserved. (직원 전용)</p>
		</footer>
	</div>
</body>
<script src="schedule_management.js">

let delBtn = $("#delBtn");
let delForm = $("#delForm");

delBtn.on("click", function(){
	delForm.attr("action", "/emp/audition/delete.do");
	delForm.attr("method", "get");
	delForm.submit();
})



</script> 
</html>