<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib uri="jakarta.tags.functions" prefix="fn" %>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDTOWN - 오디션 일정 관리</title>
    <%@ include file="../../../modules/headerPart.jsp" %>
    <link rel="stylesheet" href="<%=request.getContextPath()%>/resources/css/pages/audition_management_style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
	.float-right-btn {
    float: right; /* 등록버튼 오른쪽으로 위치시킴 */
}
</style>   
</head>
<body>
     <div class="emp-container">
     	<%@ include file="../../modules/header.jsp" %>
        <div class="emp-body-wrapper">
        	<%@ include file="../../modules/aside.jsp" %>
<!-- main 페이지 -->
            <main class="emp-content">
                <section id="schedule-management-section" class="am-section active-section">
                    <div class="am-section-header">
                        <h2>오디션 일정 관리</h2>
                        <button type="button" id="formBtn" name="formBtn"class="am-btn primary float-right-btn"><i class="fas fa-plus-circle"></i> 새 오디션 등록</button>
                    </div>
                    <div class="am-section-content">
                        <div class="am-filter-area float-right-btn">
                        	<form class="input-group input-group-sm " method="get" id="searchForm">
                        		<input type="hidden" name="page" id="page"/>	                            
	                            <select id="filter-schedule-status" name="searchType" class="am-filter-select" onchange="this.form.submit();" style="height:40px; border-radius:5px; border:1px solid #ccc; width:220px; font-size:1em;">
							         <option value="all" ${searchType == 'all' ? 'selected' : ''}>전체 상태</option>
							        <option value="ADSC003" ${searchType == 'ADSC003' ? 'selected' : ''}>예정</option>
							        <option value="ADSC001" ${searchType == 'ADSC001' ? 'selected' : ''}>진행중</option>
							        <option value="ADSC002" ${searchType == 'ADSC002' ? 'selected' : ''}>마감/종료</option> 
	                            </select>
	                            <input type="text" name="searchWord" id="search-schedule-input" placeholder="오디션명 검색" class="am-search-input" style="width:220px; height:40px; border-radius:5px; border:1px solid #ccc; padding:0 12px; font-size:1em;" value="${searchWord }">
	                            <button type="submit" id="btn-search-schedule" class="am-btn" >
	                            	<i class="fas fa-search"></i> 검색
	                            </button>
                            </form>
                        </div>
                        <table class="am-table" id="schedule-table">
                            <thead>
                                <tr>
                                    <th>오디션 ID</th>
                                    <th>오디션명</th>
                                    <th>모집 기간</th>
                                    <th>진행 상태</th>
                                    <th>담당자</th>

                                </tr>
                            </thead>
                            <tbody id="schedule-table-body">
                                <c:forEach var="audition" items="${auditionList}">
					                <tr>
					                    <td>${audition.audiNo}</td>
					                    <td>
						                    <a href="/emp/audition/detail.do?audiNo=${audition.audiNo }" class="detail-link aDetail">
						                    	${audition.audiTitle}
						                    </a>
					                    </td>
					                    <td>
					                    	<c:set value="${fn:split(audition.audiStartDate, ' ')}" var="auditionStartDate"/>
		                       				<c:set value="${fn:split(audition.audiEndDate, ' ')}" var="auditionEndDate"/>
		                       				${auditionStartDate[0]} ~ ${auditionEndDate[0]}
		                       			</td>
					                    <td>
					                    	욕설
					                    </td>
					                    <td>${audition.empUsername}</td>
					                </tr>
					            </c:forEach>
					            <c:if test="${empty auditionList}">
					                <tr>
					                    <td colspan="9">등록된 오디션이 없습니다.</td>
					                </tr>
					            </c:if>
                            </tbody>
                        </table>
                        <div class="am-pagination" id="pagingArea">
                            ${pagingVO.pagingHTML }
                            <sec:csrfInput/>
                        </div>
                    </div>
                </section>
            </main>
<!--  main 끝 -->
        </div>
    </div> 
<!-- 성공시 알림창 -->	
	<script>
    $(function(){
        <c:if test="${not empty message}">
        var message = "${message}"; // 컨트롤러에서 넘어온 message 값을 JavaScript 변수에 할당

        if (typeof swal === 'function') {
            swal({
                title: "알림",
                text: message,
                icon: "success",
                button: "확인",
            });
        }
    </c:if>
    });
    </script>     
</body>
<%@ include file="../../../modules/footerPart.jsp" %>

<%@ include file="../../../modules/sidebar.jsp" %>
<script type="text/javascript">
$(function(){
	let formBtn = $("#formBtn");	// 등록버튼

	let pagingArea = $("#pagingArea");	//페이징 영역
	let searchForm = $("#searchForm");	//검색 Form 태그 Element
	
	//등록페이지 이동
	formBtn.on("click", function(){
		location.href = "/emp/audition/form.do";
	})
	
	
	
})

</script>


</html>