package kr.or.ddit.ddtown.service.admin.faqInquiry;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import kr.or.ddit.ServiceResult;
import kr.or.ddit.ddtown.mapper.admin.faqInquiry.IAdminInquiryMapper;
import kr.or.ddit.vo.PaginationInfoVO;
import kr.or.ddit.vo.inquiry.InquiryCntGroupVO;
import kr.or.ddit.vo.inquiry.InquiryCodeVO;
import kr.or.ddit.vo.inquiry.InquiryVO;

@Service
public class AdminInquiryService implements IAdminInquiryService {

	@Autowired
	private IAdminInquiryMapper adminInquiryMapper;

	@Override
	public Map<Object, Object> getList(PaginationInfoVO<InquiryVO> pagingVO) {

		Map<Object, Object> map = new HashMap<>();

		List<InquiryVO> list = adminInquiryMapper.getList(pagingVO);

		List<InquiryCodeVO> typeCodeList = adminInquiryMapper.getTypeCodeList();
		
		List<InquiryCodeVO> statCodeList = adminInquiryMapper.getStatCodeList();
		
		InquiryCntGroupVO cnt = adminInquiryMapper.getCnt(pagingVO);

		if (list.size() > 0) {
			pagingVO.setTotalRecord(cnt.getTotalRecord());
		}

		map.put("inqVOList", list);
		map.put("pagingVO", pagingVO);
		map.put("typeCodeList", typeCodeList);
		map.put("receiptCnt", cnt.getReceiptCnt());
		map.put("completedCnt", cnt.getCompletedCnt());
		map.put("totalCnt", cnt.getTotalRecord());
		map.put("statCodeList", statCodeList);

		return map;
	}

	@Override
	public InquiryVO getData(int inqNo) {

		InquiryVO inqVO = adminInquiryMapper.getData(inqNo);

		return inqVO;
	}

	@Override
	public ServiceResult updateAnswer(InquiryVO inqVO) {

		ServiceResult result = null;

		
		if("ISC001".equals(inqVO.getStatDetailCode())) {
		inqVO.setStatDetailCode("ISC002"); }
		

		int status = adminInquiryMapper.updateAnswer(inqVO);

		if (status > 0) {
			result = ServiceResult.OK;
		} else {
			result = ServiceResult.FAILED;
		}

		return result;
	}

}
