<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/components/translation.css">

<div id="google_translate_element" style="display:none;"></div>

    <!-- <select  id="translateSelectBar">
    	<option value="ko" class="ko">ğŸ‡°ğŸ‡·</option>
    	<option value="en" class="en">ğŸ‡ºğŸ‡¸</option>
    	<option value="ja" class="ja">ğŸ‡¯ğŸ‡µ</option>
    	<option value="zh-CN" class="zh-CN">ğŸ‡¨ğŸ‡³</option>
    </select> -->
    
    <div class="custom-language-selector">
    <div class="selected-language">
        <span class="flag ko"></span> <span>í•œêµ­ì–´</span>  <span class="arrow">&#9662;</span> </div>
    <ul class="language-options">
        <li><a href="javascript:void(0);" class="translation-link korean" data-lang="ko" title="í•œêµ­ì–´"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOklEQVR4nNWSv0vDQBTH8yc5CeKkFUEdRNTFSRDBSXRycHFwERcHV0fRqiFNImrRtpKQ0GLE0FahWk3aotRBmh9381fuwKBJFifx4Mt73/f4PN5xJwj/81BKZwghLpPnea2vPE1BEEQ54wRCyDylFEyScgrNMHkeV1HTcVm6jjzjIti6s3F4IqF8Y4GGIcjRPsjmOo/M27U6xJyKav0+CXueB90ssyLozhZIph/+6CDk5W087GV5XTNM9Hw/CX8Xmcxw+GBlFwNjx5iYkxPXIHE4DEMeG6tr+BgfwuKSwuHZhbMffRqHH5vPyEoyut13lHQXI9MSB4enJO5ZXcypcNxWEm53OhBlFfmrAm++vvVgVNo8Mq+cXyBfKPIhqWtXrFu8OE7qUzWemrCrtcTafZTSjd+KcX/3tz8B7wkDnSODMroAAAAASUVORK5CYII=" alt="south-korea"><span class="flag ko"></span>í•œêµ­ì–´</a></li>
        <li><a href="javascript:void(0);" class="translation-link english" data-lang="en" title="English"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVR4nGNgGJpgbt6sTZFhq/7DcEjgCjj7SmjMn09hXr+x4Q8djT0Mbb2n5jf0nPvf1Hf+f3HDyf8ZZUf/59ee+F/dceb/mRN3/r958hQrfvv0aQrDjJw5+9smXvhf0njyf3rpkf9lzaf+t0+6+L998sX/l/zC/3/xdcSKP3Y2zWDo6Dy+sLLtNNimwroT/+PzDv7PqTr2v7z51P8z+y//f3vzFnZ85146w6KSeZsz41b+B+H06BX/06A4I3bl/+sJ6f8/JUdgxR8m9ExkeHfqeP67I4f/k4xPHc9n+DBnWufHioL/pOIPc6Z1MrzdubPs/bpV/0nFb3fuLGN439uW+LE89zypGKRvoNMomQAA3l+FS98+aDEAAAAASUVORK5CYII=" alt="usa"><span class="flag en"></span>English</a></li>
        <li><a href="javascript:void(0);" class="translation-link japanese" data-lang="ja" title="æ—¥æœ¬èª"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAi0lEQVR4nGNgGDDw4cMHoZfv3xuQij98+CDE8Ob9x4Q37z/+JwMn4NT86sbN/882bALTJGl+3Dfh/zU2tv9XGRjA9OP+icRpfnXjJlwjDIP4r27eIqwZ5FRkjTD8bONm8my+ys5OnM1vQH7un4gwgJ39/+MJk0gM7Zu3wE7FYuN/gpqJimeKUtiAAQDb8R4TZohSgwAAAABJRU5ErkJggg==" alt="japan"><span class="flag ja"></span>æ—¥æœ¬èª</a></li>
        <li><a href="javascript:void(0);" class="translation-link chinese" data-lang="zh-CN" title="ä¸­æ–‡(ç®€ä½“)"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVR4nGNgGHngvzED139rBgeqYGMGLob/1gza/20Z/mPF7szYxXFhawZtTANdoIa4Mv//XyVKoYGB7P//d0qhKorm+v8/iJ0MA3MF/v8/Z/j//z3z//+nyP7/78AIUeTD+v+/FwuZLtyr/f//ZeP//wPYEIoiOFH5RBvowPj/fyQnJAxDOBCKQN71I8dAWzTswvT/f7MEFWLZFortGf7/d2SiooG2ZGDrEWqgMZULB4YRBwAcn0PlCmQs1wAAAABJRU5ErkJggg==" alt="china"><span class="flag zh-CN"></span>ä¸­æ–‡(ç®€ä½“)</a></li>
        <li><a href="javascript:void(0);" class="translation-link russian" data-lang="ru" title="Ğ ÑƒÑÑĞºĞ¸Ğ¹"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVR4nOXUuw2AMAyE4asjCuaIS8rwHAFlVsQiaVFikMs0LGCWsIQQJ33tXx7wv4mIy/maLYiIAzNT4VMtMDN9IJhS8Ucu1UJKxWOJO03rphaWuNMfg3ff+Dq21cLdNx4aQDpATQTQF4IdnAbMJjq4t8/uhT3H8cmtKO8dawAAAABJRU5ErkJggg==" alt="russian-federation"><span class="flag ru"></span>Ğ ÑƒÑÑĞºĞ¸Ğ¹</a></li>
        <li><a href="javascript:void(0);" class="translation-link spanish" data-lang="es" title="EspaÃ±ol"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAYUlEQVR4nGNgGHngqTED121tBgdq4KfGDFwMtzUZtO/qMPynBr6tyaA9BAx8V8Xs/Wcr239q4HdVzN4M72qZ/f8fZP9PDfyultl/RBpYReVIuT3o0+Ftahv4lNqFA8OIAwCLlVobCmvKPgAAAABJRU5ErkJggg==" alt="spain"><span class="flag es"></span>EspaÃ±ol</a></li>
    </ul>
</div>
    

<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script type="text/javascript">
    // Google Translate Element ì´ˆê¸°í™” í•¨ìˆ˜
    function googleTranslateElementInit() {
        console.log("googleTranslateElementInit CALLED.");
        new google.translate.TranslateElement(
            {
                pageLanguage: 'ko', // ì›¹ í˜ì´ì§€ì˜ ê¸°ë³¸ ì–¸ì–´
                autoDisplay: false,
                includedLanguages: 'ko,en,ja,zh-CN,es,ru', // ë²ˆì—­ ì œê³µ ì–¸ì–´
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            },
            'google_translate_element'
        );
    }

    // ì¿ í‚¤ ì„¤ì • í•¨ìˆ˜
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            let date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        // googtrans ì¿ í‚¤ëŠ” path=/ ë¡œ ì„¤ì •ë˜ì–´ì•¼ Google Translateê°€ ì¸ì‹í•©ë‹ˆë‹¤.
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
        console.log("Cookie set: " + name + "=" + value);
    }

    // ì¿ í‚¤ ê°€ì ¸ì˜¤ê¸°
    function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }

    // DOM ë¡œë“œ ì™„ë£Œ í›„ ì–¸ì–´ ë³€ê²½ ë§í¬ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
   document.addEventListener('DOMContentLoaded', function() {
        const customSelector = document.querySelector('.custom-language-selector');
        const selectedLanguageDiv = customSelector.querySelector('.selected-language');
        const languageOptionsUl = customSelector.querySelector('.language-options');

        // í˜„ì¬ ì„ íƒëœ ì–¸ì–´ í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSelectedLanguageDisplay(langCode, langText, flagClass) {
            const flagSpan = selectedLanguageDiv.querySelector('.flag');
            const textSpan = selectedLanguageDiv.querySelector('span:not(.flag):not(.arrow)');
            if (flagSpan) flagSpan.className = 'flag ' + flagClass; // êµ­ê¸° ì•„ì´ì½˜ í´ë˜ìŠ¤ ë³€ê²½
            if (textSpan) textSpan.textContent = langText;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¿ í‚¤ì—ì„œ í˜„ì¬ ë²ˆì—­ ì–¸ì–´ ê°€ì ¸ì™€ì„œ selected-language ì—…ë°ì´íŠ¸
        const currentGoogTrans = getCookie('googtrans');
        if (currentGoogTrans && currentGoogTrans.includes('/')) {
            const langParts = currentGoogTrans.split('/');
            if (langParts.length > 2 && langParts[2]) {
                const activeLangCode = langParts[2];
                const activeLink = languageOptionsUl.querySelector('a[data-lang="' + activeLangCode + '"]');
                if (activeLink) {
                    const langText = activeLink.textContent.trim() || activeLink.innerText.trim(); // ë¸Œë¼ìš°ì € í˜¸í™˜ì„±
                    const flagClass = activeLink.querySelector('.flag') ? activeLink.querySelector('.flag').className.replace('flag ', '') : activeLangCode;
                    updateSelectedLanguageDisplay(activeLangCode, langText, flagClass);
                }
            }
        }


        // ì„ íƒëœ ì–¸ì–´ í‘œì‹œ ì˜ì—­ í´ë¦­ ì‹œ ì˜µì…˜ ëª©ë¡ í† ê¸€
        selectedLanguageDiv.addEventListener('click', function() {
            languageOptionsUl.style.display = languageOptionsUl.style.display === 'block' ? 'none' : 'block';
        });

        // ì˜µì…˜ ë§í¬ í´ë¦­ ì‹œ ì–¸ì–´ ë³€ê²½
        languageOptionsUl.addEventListener('click', function(event) {
            let clickedLink = event.target.closest('a.translation-link');

            if (clickedLink) {
                event.preventDefault();
                const targetLang = clickedLink.getAttribute('data-lang');
                const sourceLang = 'ko'; // í˜ì´ì§€ì˜ ê¸°ë³¸ ì–¸ì–´
                const langText = clickedLink.textContent.trim() || clickedLink.innerText.trim(); // í´ë¦­ëœ ë§í¬ì˜ í…ìŠ¤íŠ¸
                const flagClass = clickedLink.querySelector('.flag') ? clickedLink.querySelector('.flag').className.replace('flag ', '') : targetLang;

                if (targetLang) {
                    console.log("Language link clicked. Setting googtrans cookie to: /" + sourceLang + "/" + targetLang);
                    setCookie('googtrans', '/' + sourceLang + '/' + targetLang, 1);
                    updateSelectedLanguageDisplay(targetLang, langText, flagClass); // ì„ íƒëœ ì–¸ì–´ UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                    languageOptionsUl.style.display = 'none'; // ì˜µì…˜ ëª©ë¡ ìˆ¨ê¸°ê¸°
                    window.location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë²ˆì—­ ì ìš©
                }
            }
        });

        document.addEventListener('click', function(event) {
            if (!customSelector.contains(event.target)) {
                languageOptionsUl.style.display = 'none';
            }
        });
    });
</script>