<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    <%@ taglib uri="jakarta.tags.functions" prefix="fn" %>
    
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>블랙리스트 관리 - DDTOWN 관리자</title>

    <%@ include file="../../modules/headerPart.jsp" %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .current-info {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 6px;
            font-size: 0.95em;
        }
        .current-info strong {
            color: #333;
        }
        .emp-form .form-group textarea#blacklistReasonText {
            min-height: 150px;
        }
		.blacklist-status-badge {
		    display: inline-block; /* 텍스트 크기만큼만 공간 차지 */
		    padding: 0.25em 0.6em; /* 내부 여백 */
		    font-size: 0.75em;     /* 폰트 크기 */
		    font-weight: 700;      /* 폰트 굵기 */
		    line-height: 1;        /* 줄 높이 */
		    text-align: center;    /* 텍스트 중앙 정렬 */
		    white-space: nowrap;   /* 텍스트 줄바꿈 방지 */
		    vertical-align: baseline; /* 세로 정렬 */
		    border-radius: 12rem; /* 둥근 모서리 */
		    opacity: 0.8; /* 약간의 투명도 */
		}
		
		/* '비활성' 상태일 때의 스타일 */
		.blacklist-status-badge.status-inactive {
		    color: #fff; /* 글자색 흰색 */
		    background-color: #6c757d; /* 회색 배경 (부트스트랩의 secondary/gray와 유사) */
		    /* 또는 경고색: background-color: #ffc107; */
		}
		
		/* '활성' 상태일 때의 스타일 */
		.blacklist-status-badge.status-active {
		    color: #fff; /* 글자색 흰색 */
		    background-color: #28a745; /* 녹색 배경 (부트스트랩의 success/green과 유사) */
		    /* 또는 파란색: background-color: #007bff; */
		}
		 /* 버튼비활성화 */
		.disabled-button {
		    cursor: not-allowed;
		    opacity: 0.6;
		    /* 다른 비활성화 스타일 (예: 배경색 변경) */
		    background-color: #cccccc;
		    color: #666666;
		}
    </style>
</head>
<body>
    <div class="emp-container">
        <%@ include file="../modules/header.jsp" %>
        <div class="emp-body-wrapper">
            <%@ include file="../modules/aside.jsp" %>
            <main class="emp-content">
            	<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
					<ol class="breadcrumb">
					  <li class="breadcrumb-item"><a href="#" style="color:black;">아티스트 커뮤니티 관리</a></li>
					  <li class="breadcrumb-item location"><a href="/admin/community/blacklist/list" style="color:black;">블랙리스트 관리</a></li>
					  <li class="breadcrumb-item active" aria-current="page">상세</li>
					</ol>
				</nav>
                <section id="blacklistReasonFormSection" class="ea-section active-section">
                    <div class="ea-section-header">
                        <h2 id="blacklistFormTitle">블랙리스트 사유 상세
                        	<td>
							    <span class="blacklist-status-badge
							        <c:choose>
							            <c:when test="${blacklist.banActYn eq 'N'}">status-inactive</c:when>
							            <c:when test="${blacklist.banActYn eq 'Y'}">status-active</c:when>
							        </c:choose>
							    ">
							        <c:choose>
							            <c:when test="${blacklist.banActYn eq 'N'}">비활성</c:when>
							            <c:when test="${blacklist.banActYn eq 'Y'}">활성</c:when>
							        </c:choose>
							    </span>
							</td>
					    </h2>
					    <button type="button" class="ea-btn primary" id="modBtn">수정</button>
                    </div>

                    <div class="current-info">
                        <p><strong>대상 회원 ID:</strong> <span id="targetUserId">${blacklist.memUsername }</span></p>
                        <p><strong>현재 지정 사유:</strong>
                           <span id="currentBlacklistReason">
                           <c:choose>
                              	<c:when test="${blacklist.banReasonCode eq 'BRC001'}">스팸</c:when>
                              	<c:when test="${blacklist.banReasonCode eq 'BRC002'}">욕설</c:when>
                              	<c:when test="${blacklist.banReasonCode eq 'BRC003'}">음란물</c:when>
                              	<c:when test="${blacklist.banReasonCode eq 'BRC004'}">기타</c:when>
                            </c:choose>
                           </span>
                       </p>
                    </div>

                    <form class="ea-form" id="blacklistReasonForm">
                        <input type="hidden" id="blacklistRecordId" name="blacklistRecordId">
                        <input type="hidden" id="targetMemberIdHidden" name="targetMemberId">

                        <div class="form-group">
                            <label for="blacklistReasonText">추가 사항 및 상세</label>
                            <span>${blacklist.banReasonDetail }</span>
                        </div>

                        <div class="form-group-group" style="display: flex; gap: 16px; align-items: flex-end;">
                            <div class="form-group" style="flex:1;">
                                <label for="blacklistReleaseDate">정지 기간</label>
                                 <li><strong>차단 시작 일시:</strong><c:set value="${fn:split(blacklist.banStartDate, ' ')}" var="banStartDate"/> ${banStartDate[0]}</li> 
		                    	<li><strong>차단 해제 일시:</strong><c:set value="${fn:split(blacklist.banEndDate, ' ')}" var="banEndDate"/> ${banEndDate[0]}</li>
                            </div>                           
                        </div>
                        <label for="blacklistReleaseDate">차단 담당자</label>
                        <span>${blacklist.empUsername }</span>
                        <div class="ea-form-actions">
                            <button type="button" class="ea-btn success" id="delBtn" style="margin-right: auto;">
                            	<i class="fas fa-undo"></i>즉시 해제
                            </button>
                            <a href="/admin/community/blacklist/list" class="ea-btn outline">목록</a>
                        </div>
                    </form>
                    <form action="/admin/community/blacklist/delete"  method="post" id="delForm">
						<input type="hidden" name="banNo" value="${blacklist.banNo}" />		                   
						<input type="hidden" name="memUsername" value="${blacklist.memUsername}" />		                   
		                <sec:csrfInput/>
					</form>
                </section>
            </main>
        </div>
    </div>
<%@ include file="../../modules/footerPart.jsp" %>

<%@ include file="../../modules/sidebar.jsp" %>  
 <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
 <script>
 $(function(){
	 $("#modBtn").on("click", function(){
	        location.href = "/admin/community/blacklist/modForm?banNo=${blacklist.banNo }";
	    });
 })
      
let delBtn = $("#delBtn");
let delForm = $("#delForm");
      
delBtn.on("click", function(){ 
	console.log("버튼 클릭됨!");
	delForm.submit();
})


$(document).ready(function() {

    var banActYn = "${blacklist.banActYn}"; //

    // 2. 상태에 따라 '수정' 버튼 제어
    if (banActYn === 'N') {
        // blacklist.banActYn이 'N' (비활성)일 경우
        $('#modBtn').prop('disabled', true); // 버튼을 비활성화
        $('#modBtn').addClass('disabled-button');
    } else {
        // blacklist.banActYn이 'Y' (활성)일 경우 (또는 다른 상태일 경우)
        $('#modBtn').prop('disabled', false); // 버튼을 활성화
        $('#modBtn').removeClass('disabled-button'); // 스타일링 클래스 제거
    }
});

</script>
</body>
</html> 