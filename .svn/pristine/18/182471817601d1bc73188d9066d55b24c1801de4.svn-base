<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="jakarta.tags.fmt" prefix="fmt" %>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시물 관리 - DDTOWN 직원 포털</title>
    <%@ include file="../../modules/headerPart.jsp" %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" ></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        .post-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; background: #fff; }
        .post-table th, .post-table td { border: 1px solid #e0e0e0; padding: 12px 10px; text-align: center; font-size: 1em; }
        .post-table th { background: #f5f5f5; font-weight: 600; }
        .post-table td.content { text-align: left; }
        .post-table td .detail-btn { padding: 6px 18px; border: 1.5px solid #1976d2; background: #fff; color: #1976d2; border-radius: 6px; font-size: 1em; cursor: pointer; transition: background 0.2s, color 0.2s; }
        .post-table td .detail-btn:hover { background: #1976d2; color: #fff; }
    </style>
</head>
<body>
    <div class="emp-container">
        <%@ include file="../modules/header.jsp" %>
        <div class="emp-body-wrapper">
            <%@ include file="../modules/aside.jsp" %>
            <main class="emp-content" style="position:relative; min-height:600px;">
                <h2 style="margin-bottom:18px;">게시물 관리</h2>
                
                <!-- 검색 영역 추가 -->
                <div class="search-container" style="background:#fff; padding:20px; border-radius:8px; margin-bottom:20px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
                    <div class="search-row" style="display:flex; align-items:center; gap:12px; margin-bottom:12px;">
                    	<form id="searchForm" action="/emp/post/list" method="get">
	                        <select id="searchType" name="searchType" style="padding:8px 12px; border:1px solid #ddd; border-radius:4px; min-width:150px;">
	                        	<option value="" id="searchAll">전체</option>
	                            <option value="content">내용</option>
	                        </select>
	                        
	                        <input type="text" id="searchWord" name="searchWord" value="<c:if test="${not empty pagingVO.searchWord }">${pagingVO.searchWord }</c:if>" placeholder="내용을 입력해주세요" />
	                        <button type="button" class="btn btn-primary" id="searchBtn" >검색</button>
	                        <button type="button" class="btn btn-primary" id="reset" >검색 초기화</button>
                    	</form>
                    </div>
                </div>
                
                <table class="post-table">
                    <thead>
                        <tr>
                        	<th>순번</th>
                            <th>ID</th>
                            <th>
                            	<div class="dropdown">
                            	<button class="btn btn-secondary dropdown-toggle" id="selectArtist" type="button" data-bs-toggle="dropdown" aria-expanded="false">
								  아티스트
								</button>
								<ul class="dropdown-menu">
									<li><button class="dropdown-item" type="button" name="selectArtist" value="">전체</button></li>
									<c:forEach items="${artistList }" var="artistOne">
										<li><hr class="dropdown-divider"></li>
										<li><button class="dropdown-item" type="button" name="selectArtist" value="${artistOne.artNo }"><c:out value="${artistOne.artNm }"/></button></li>
									</c:forEach>
								</ul>
                            	</div>
                            </th>
                            <th>내용</th>
                            <th>멤버십 여부</th>
                            <th>작성일</th>
                            <th>댓글 수</th>
                            <th>좋아요 수</th>
                            <th>삭제여부</th>
                        </tr>
                    </thead>
                    <tbody>
                    	<c:forEach items="${pagingVO.dataList }" var="post">
                    		<tr>
                    			<td><c:out value="${post.rnum }" /></td>
	                            <td><c:out value="${post.comuPostNo }" /></td>
	                            <td><c:out value="${post.writerProfile.artistVO.artNm }"/></td>
	                            <td class="content"><a href="/emp/post/detail/${post.comuPostNo }"><c:out value="${post.comuPostContent }"/></a></td>
	                            <td><c:out value="${post.comuPostMbspYn }"/></td>
	                            <td><fmt:formatDate value="${post.comuPostRegDate }" pattern="yyyy-MM-dd HH:mm:ss"/></td>
	                            <td><c:out value="${post.comuPostReplyCount }" /></td>
	                            <td><c:out value="${post.comuPostLike }" /></td>
	                            <td><c:out value="${post.comuPostDelYn }" /></td>
	                        </tr>
                    	</c:forEach>
                    </tbody>
                </table>
            </main>
        </div>
    </div>
<%@ include file="../../modules/footerPart.jsp" %>

<%@ include file="../../modules/sidebar.jsp" %>   
</body>
<script>

$(function(){
// 	$("#selectArtist").on("hidden.bs.dropdown",function(e){
// 		console.log($(this));
// 		console.log("e: " ,e.clickEvent.target.value);
// 	})
	
	$(".dropdown-menu").on("click","button",function(e){
		console.log("e",e.target.value);
	});
	
	$("#searchBtn").on("click",function(){
		
		if($("#searchWord").val() == null || $("#searchWord").val() == ''){
			alert("검색어를 입력해주세요");
			return false;
		}
		
		$("#searchForm").submit();
	});
	
	$("#reset").on("click",function(){
		$("#searchAll").prop("selected",true);
		$("#searchWord").val("");
		
		$("#searchForm").submit();
	});
});

</script>
</html> 